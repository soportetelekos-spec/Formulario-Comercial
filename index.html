<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Propuesta Comercial - Telekos</title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #e9f3ff 0%, #f9fbff 100%);
  color: #222;
  margin: 0;
  padding: 0;
}

/* CUADRO DE PROPUESTA */
.propuesta {
  max-width: 1000px;
  margin: 20px auto;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  overflow: hidden;
  position: relative;
}

/* HEADER CON FONDO AZUL */
.propuesta header {
  background-color: #003b75;
  padding: 40px 30px;
  position: relative;
  text-align: center;
}
.propuesta header h1 {
  color: white;
  margin: 0;
  font-size: 1.9rem;
}

/* LOGO DENTRO DEL HEADER */
.propuesta header .logo {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 225px;
  height: auto;
  opacity: 0.5;
}

/* TIMELINE */
.timeline {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 100%;
  margin: 20px 0;
  padding: 10px 0;
  position: relative;
}
.timeline::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 30px;
  right: 30px;
  height: 4px;
  background: #c9defa;
  z-index: 0;
  transform: translateY(-50%);
}
.step {
  position: relative;
  text-align: center;
  z-index: 1;
  flex: 1;
  color: #004b8d;
  font-weight: 600;
}
.circle {
  width: 28px;
  height: 28px;
  background: #c9defa;
  border-radius: 50%;
  margin: 0 auto 6px;
  border: 3px solid #004b8d;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  transition: all 0.3s;
}
.step.active .circle {
  background: #ee930b;
  border-color: #005bb5;
  box-shadow: 0 0 8px rgba(0,116,225,0.5);
}
.step.active {
  color: #0074e1;
}

/* DETAILS */
details {
  background: white;
  margin: 20px 0;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  border-left: 4px solid #004b8d;
  transition: all 0.2s ease-in-out;
}
details:hover {
  background-color: #f2f8ff;
  border-left: 4px solid #0080ff;
}
summary {
  font-size: 1.15rem;
  font-weight: 600;
  color: #004b8d;
  cursor: pointer;
  outline: none;
  padding: 10px 0;
  transition: color 0.2s ease-in-out;
}
details:hover summary {
  color: #0080ff;
}

/* FORMULARIO */
label {
  display: block;
  font-weight: 600;
  margin-top: 8px;
  color: #003b75;
}
input, textarea {
  width: 100%;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #ccd9e8;
  margin-bottom: 10px;
  font-size: 0.9rem;
  background-color: #fdfdfd;
}
input:focus, textarea:focus {
  border-color: #0074e1;
  outline: none;
  box-shadow: 0 0 4px rgba(0,116,225,0.3);
}
table {
  width: 100%;
  border-collapse: collapse;
  margin: 10px 0;
}
th, td {
  border: 1px solid #dee7f3;
  padding: 8px;
  text-align: center;
}
th {
  background-color: #e3f2fd;
  color: #003b75;
}
.btn {
  background-color: #004b8d;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  margin-top: 10px;
  transition: background 0.3s;
}
.btn:hover {
  background-color: #0074e1;
}
.totales {
  font-weight: bold;
  text-align: right;
  color: #003b75;
}
mark {
  background-color: #d9edff;
  color: #003b75;
  padding: 2px 5px;
  border-radius: 4px;
}
.footer {
  text-align: center;
  font-size: 0.8rem;
  color: #666;
  margin: 40px 0 20px;
}
</style>
</head>
<body>

<div class="propuesta">
  <!-- HEADER CON LOGO -->
  <header>
    <img src="logo.png" alt="Logo Telekos" class="logo">
    <h1>Propuesta Comercial - Telekos</h1>
  </header>

  <!-- TIMELINE -->
  <div class="timeline">
    <div class="step" data-step="1"><div class="circle"></div>Cliente</div>
    <div class="step" data-step="2"><div class="circle"></div>Propuesta</div>
    <div class="step" data-step="3"><div class="circle"></div>Estudio</div>
    <div class="step" data-step="4"><div class="circle"></div>Aprobaci√≥n</div>
    <div class="step" data-step="5"><div class="circle"></div>Instalaci√≥n</div>
    <div class="step" data-step="6"><div class="circle"></div>Activo</div>
  </div>

  <!-- FORMULARIO -->
  <form action="https://formsubmit.co/soporte@telekos.com" method="POST" id="telekosForm">
    <input type="hidden" name="_next" value="https://soportetelekos-spec.github.io/Formulario-Comercial/gracias.html">
    <input type="hidden" name="_html" value="true">
    <input type="hidden" name="_template" value="table">
    <input type="hidden" name="_body" id="bodyEmail">

    <!-- DATOS DEL CLIENTE -->
    <details open>
      <summary>Datos del Cliente</summary>
      <label>Nombre de la Empresa:</label><input type="text" name="empresa" id="empresa" required>
      <label>Atenci√≥n de:</label><input type="text" name="atencion">
      <label>Domicilio:</label><input type="text" name="domicilio">
      <label>CP / Provincia / Localidad:</label><input type="text" name="cp_prov_localidad">
      <label>NIF / CIF / NIE:</label><input type="text" name="nif">
      <label>Tel√©fono:</label><input type="text" name="telefono">
      <label>Email:</label><input type="email" name="email_cliente">
    </details>

    <!-- COMERCIAL -->
    <details>
      <summary>Comercial Telekos</summary>
      <label>Nombre y Apellidos:</label><input type="text" name="comercial_nombre">
      <label>Tel√©fono M√≥vil:</label><input type="text" name="comercial_movil">
      <label>Email:</label><input type="email" name="comercial_email">
      <label>Tel√©fono Fijo:</label><input type="text" name="comercial_fijo" value="91 088 50 50">
    </details>

    <!-- SERVICIOS -->
    <details>
      <summary>Servicios Contratados</summary>
      <table id="tablaServicios">
        <thead>
          <tr>
            <th>Cant.</th>
            <th>Servicio</th>
            <th>Coste Mensual (‚Ç¨)</th>
            <th>Total (‚Ç¨)</th>
            <th>Eliminar</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="number" name="cant[]" min="1" value="1" class="cant"></td>
            <td><input type="text" name="servicio[]" placeholder="Centralita en la nube, SMS, etc."></td>
            <td><input type="number" name="coste[]" step="0.01" value="0" class="coste"></td>
            <td class="total">0.00</td>
            <td><button type="button" class="btn eliminar">X</button></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn" id="agregarServicio">‚ûï Agregar servicio</button>
      <label>Coste de instalaci√≥n (‚Ç¨ IVA incl.):</label><input type="number" step="0.01" id="instalacion" name="instalacion" value="0">
      <p class="totales">Subtotal mensual: <span id="subtotal">0.00</span> ‚Ç¨</p>
      <p class="totales">IVA (21%): <span id="iva">0.00</span> ‚Ç¨</p>
      <p class="totales">Total mensual con IVA: <span id="totalConIVA">0.00</span> ‚Ç¨</p>
    </details>

    <!-- ESTUDIO -->
    <details>
      <summary>Estudio del Cliente y Amortizaci√≥n</summary>
      <h3 style="color:#004b8d;">Comparativa de Gastos</h3>
      <table id="tablaEstudio">
        <thead>
          <tr>
            <th>Servicio</th>
            <th>Gasto Actual (‚Ç¨)</th>
            <th>Nuevo Gasto (‚Ç¨)</th>
            <th>Ahorro Mensual (‚Ç¨)</th>
            <th>Eliminar</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="text" name="servicio_estudio[]" placeholder="Telefon√≠a fija, m√≥vil, etc."></td>
            <td><input type="number" name="gasto_actual[]" step="0.01" class="gasto_actual" value=""></td>
            <td><input type="number" name="nuevo_gasto[]" step="0.01" class="nuevo_gasto" value=""></td>
            <td><input type="number" name="ahorro_mensual[]" step="0.01" class="ahorro_mensual" readonly></td>
            <td><button type="button" class="btn eliminarEstudio">X</button></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn" id="agregarEstudio">‚ûï Agregar concepto</button>
      <p class="totales">Ahorro anual estimado: <span id="ahorro_anual">0.00</span> ‚Ç¨</p>
    </details>

    <!-- OBSERVACIONES Y FIRMA -->
    <details>
      <summary>Observaciones y Legales</summary>
      <textarea name="observaciones" rows="4" placeholder="Notas o condiciones especiales..."></textarea>
      <p><strong>Nota:</strong><mark> Los servicios facturados por Telekos no implican compromisos de permanencia ni penalizaciones asociadas a nuestros clientes.</mark></p>
    </details>

    <details>
      <summary>Firma Cliente</summary>
      <label>Firma electr√≥nica del Cliente, sello empresa o Nombre y Apellidos:</label>
      <input type="text" name="nombre_cliente">
      <label>Fecha:</label>
      <input type="date" name="fecha_cliente">
    </details>

    <div style="text-align:center;">
      <button type="submit" class="btn">üìß Enviar Formulario</button>
      <button type="button" class="btn" onclick="window.print()">üñ®Ô∏è Imprimir / Guardar PDF</button>
    </div>
  </form>

  <div class="footer">
    <p>Telekos ¬© 2025 ‚Äî <a href="https://www.telekos.com" target="_blank">www.telekos.com</a></p>
  </div>
</div>

<script>
   // Antes de enviar el formulario, rellenar campos vac√≠os con "nulo"
document.getElementById("telekosForm").addEventListener("submit", function(e) {
  const inputs = this.querySelectorAll("input, textarea");
  inputs.forEach(input => {
    if (input.value.trim() === "") {
      input.value = "nulo";
    }
  });

  // Campos de tabla Servicios
  tablaServicios.querySelectorAll("input").forEach(input => {
    if (input.value.trim() === "") input.value = "nulo";
  });

  // Campos de tabla Estudio (incluyendo gasto_actual y nuevo_gasto)
  tablaEstudio.querySelectorAll("input").forEach(input => {
    if (input.value.trim() === "") input.value = "nulo";
  });

  // Actualizamos el cuerpo del email
  const formData = new FormData(this);
  let body = "";
  for (let [name, value] of formData.entries()) {
    body += `<tr><td>${name}</td><td>${value}</td></tr>`;
  }
  document.getElementById("bodyEmail").value = body;
});

// Variables
const tablaServicios = document.getElementById("tablaServicios").querySelector("tbody");
const tablaEstudio = document.getElementById("tablaEstudio").querySelector("tbody");
const agregarBtn = document.getElementById("agregarServicio");
const agregarEstudioBtn = document.getElementById("agregarEstudio");
const subtotalEl = document.getElementById("subtotal");
const ivaEl = document.getElementById("iva");
const totalConIVAEl = document.getElementById("totalConIVA");
const instalacionEl = document.getElementById("instalacion");
const ahorroAnualEl = document.getElementById("ahorro_anual");
const steps = document.querySelectorAll(".step");

// Funciones de c√°lculo
function calcularTotales() {
  let subtotal = 0;
  tablaServicios.querySelectorAll("tr").forEach(row => {
    const cant = parseFloat(row.querySelector(".cant").value) || 0;
    const coste = parseFloat(row.querySelector(".coste").value) || 0;
    const total = cant * coste;
    row.querySelector(".total").textContent = total.toFixed(2);
    subtotal += total;
  });
  const instalacion = parseFloat(instalacionEl.value) || 0;
  const iva = (subtotal + instalacion) * 0.21;
  const totalConIVA = subtotal + instalacion + iva;
  subtotalEl.textContent = subtotal.toFixed(2);
  ivaEl.textContent = iva.toFixed(2);
  totalConIVAEl.textContent = totalConIVA.toFixed(2);
  actualizarTimeline();
}

function calcularEstudio() {
  let ahorroTotalMensual = 0;
  tablaEstudio.querySelectorAll("tr").forEach(row => {
    const actual = parseFloat(row.querySelector(".gasto_actual").value) || 0;
    const nuevo = parseFloat(row.querySelector(".nuevo_gasto").value) || 0;
    const ahorro = actual - nuevo;
    row.querySelector(".ahorro_mensual").value = ahorro.toFixed(2);
    ahorroTotalMensual += ahorro;
  });
  const ahorroAnual = ahorroTotalMensual * 12;
  ahorroAnualEl.textContent = ahorroAnual.toFixed(2);
}

// Timeline
function actualizarTimeline() {
  steps[0].classList.toggle("active", document.getElementById("empresa").value.trim() !== "");
  steps[1].classList.toggle("active", Array.from(tablaServicios.querySelectorAll(".coste")).some(c => parseFloat(c.value) > 0));
  steps[2].classList.toggle("active", Array.from(tablaEstudio.querySelectorAll(".gasto_actual")).some(g => g.value.trim() !== ""));
  steps[3].classList.toggle("active", document.querySelector("textarea[name='observaciones']").value.trim() !== "");
  steps[4].classList.toggle("active", parseFloat(instalacionEl.value) > 0);
  steps[5].classList.toggle("active", document.querySelector("input[name='fecha_cliente']").value.trim() !== "");
}

// Event listeners
agregarBtn.addEventListener("click", () => {
  const fila = document.createElement("tr");
  fila.innerHTML = `<td><input type="number" name="cant[]" min="1" value="1" class="cant"></td>
    <td><input type="text" name="servicio[]" placeholder="Nuevo servicio"></td>
    <td><input type="number" name="coste[]" step="0.01" value="0" class="coste"></td>
    <td class="total">0.00</td>
    <td><button type="button" class="btn eliminar">X</button></td>`;
  tablaServicios.appendChild(fila);
});
agregarEstudioBtn.addEventListener("click", () => {
  const fila = document.createElement("tr");
  fila.innerHTML = `<td><input type="text" name="servicio_estudio[]" placeholder="Nuevo concepto"></td>
    <td><input type="number" name="gasto_actual[]" step="0.01" class="gasto_actual"></td>
    <td><input type="number" name="nuevo_gasto[]" step="0.01" class="nuevo_gasto"></td>
    <td><input type="number" name="ahorro_mensual[]" step="0.01" class="ahorro_mensual" readonly></td>
    <td><button type="button" class="btn eliminarEstudio">X</button></td>`;
  tablaEstudio.appendChild(fila);
});

tablaServicios.addEventListener("click", e => {
  if(e.target.classList.contains("eliminar")) { e.target.closest("tr").remove(); calcularTotales(); }
});
tablaEstudio.addEventListener("click", e => {
  if(e.target.classList.contains("eliminarEstudio")) { e.target.closest("tr").remove(); calcularEstudio(); }
});

tablaServicios.addEventListener("input", calcularTotales);
instalacionEl.addEventListener("input", calcularTotales);
tablaEstudio.addEventListener("input", calcularEstudio);
document.querySelector("textarea[name='observaciones']").addEventListener("input", actualizarTimeline);
document.getElementById("empresa").addEventListener("input", actualizarTimeline);
document.querySelector("input[name='fecha_cliente']").addEventListener("input", actualizarTimeline);

// Inicial
calcularTotales();
calcularEstudio();
actualizarTimeline();
</script>

</body>
</html>





