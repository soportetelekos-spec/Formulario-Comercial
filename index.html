<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Propuesta Comercial - Telekos</title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #e9f3ff 0%, #f9fbff 100%);
  color: #222;
  margin: 0;
  padding: 0;
}
.logo {
  position: fixed;
  top: 10px;
  left: 10px;
  width: 200px;
  opacity: 0.5;
  z-index: 1000;
  pointer-events: none;
}
header {
  background-color: #003b75;
  color: white;
  text-align: center;
  padding: 25px 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}
header h1 { margin: 0; font-size: 1.9rem; }

/* Barra de progreso */
#progressBar {
  width: 100%;
  height: 6px;
  background: #c9defa;
  border-radius: 3px;
  margin-top: -10px;
}
#progressFill {
  height: 100%;
  width: 0%;
  background: #e4990f;
  border-radius: 3px;
  transition: width 0.3s ease;
}

/* Timeline */
.timeline {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 1000px;
  margin: 20px auto;
  padding: 10px 0;
  position: relative;
}
.timeline::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 30px;
  right: 30px;
  height: 4px;
  background: #c9defa;
  z-index: 0;
  transform: translateY(-50%);
}
.step {
  position: relative;
  text-align: center;
  z-index: 1;
  flex: 1;
  color: #004b8d;
  font-weight: 600;
}
.circle {
  width: 28px; height: 28px;
  background: #c9defa;
  border-radius: 50%;
  margin: 0 auto 6px;
  border: 3px solid #004b8d;
  display: flex; align-items: center; justify-content: center;
}
.step.active .circle { background: #e4990f; border-color: #005bb5; box-shadow: 0 0 8px rgba(0,116,225,0.5); }
.step.active { color: #0074e1; }

/* Contenedores */
details {
  background: white;
  margin: 20px auto;
  padding: 15px 20px;
  border-radius: 10px;
  max-width: 1000px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  border-left: 4px solid #004b8d;
  transition: all 0.2s ease-in-out;
}
details:hover { background-color: #f2f8ff; border-left: 4px solid #0080ff; }
summary { font-size: 1.15rem; font-weight: 600; color: #004b8d; cursor: pointer; padding: 10px 0; }
details:hover summary { color: #0080ff; }

label { display: block; font-weight: 600; margin-top: 8px; }
input, textarea {
  width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccd9e8;
  margin-bottom: 10px; font-size: 0.95rem; background-color: #fdfdfd;
}
input:focus, textarea:focus { border-color: #0074e1; outline: none; box-shadow: 0 0 4px rgba(0,116,225,0.3); }

table { width: 100%; border-collapse: collapse; margin: 10px 0; }
th, td { border: 1px solid #dee7f3; padding: 8px; text-align: center; min-width: 100px; }
th { background-color: #e3f2fd; color: #003b75; }

.btn {
  background-color: #004b8d; color: white; padding: 10px 20px;
  border: none; border-radius: 8px; cursor: pointer;
  font-weight: 600; margin-top: 10px; transition: background 0.3s;
}
.btn:hover { background-color: #0074e1; }

.totales { font-weight: bold; text-align: right; color: #003b75; }
mark { background-color: #d9edff; color: #003b75; padding: 2px 5px; border-radius: 4px; }
.footer { text-align: center; font-size: 0.8rem; color: #666; margin: 40px 0 20px; }

/* Responsive m√≥vil */
@media (max-width: 600px) {
  header h1 { font-size: 1.4rem; padding: 15px 5px; }
  details { padding: 10px 15px; }
  .btn { padding: 10px; font-size: 0.9rem; width: 100%; margin-top: 8px; }
  .timeline { flex-direction: column; align-items: flex-start; padding: 10px; }
  .step { margin-bottom: 10px; text-align: left; }
  table { display: block; overflow-x: auto; }
}
@media print {
  .logo { opacity: 1; position: static; display: block; margin: 0 auto 10px; }
  header, .btn, .timeline, #progressBar { display: none; }
  body { background: white; }
}
</style>
</head>
<body>

<img src="logo.png" alt="Logo Telekos" class="logo">

<header>
  <h1>Propuesta Comercial - Telekos</h1>
</header>

<div id="progressBar"><div id="progressFill"></div></div>

<div class="timeline">
  <div class="step" data-step="1"><div class="circle"></div>Cliente</div>
  <div class="step" data-step="2"><div class="circle"></div>Propuesta</div>
  <div class="step" data-step="3"><div class="circle"></div>Estudio</div>
  <div class="step" data-step="4"><div class="circle"></div>Aprobaci√≥n</div>
  <div class="step" data-step="5"><div class="circle"></div>Instalaci√≥n</div>
  <div class="step" data-step="6"><div class="circle"></div>Activo</div>
</div>

<form action="https://formsubmit.co/soporte@telekos.com" method="POST" id="telekosForm">
  <input type="hidden" name="_next" value="https://soportetelekos-spec.github.io/Formulario-Comercial/gracias.html">
  <input type="hidden" name="_html" value="true">
  <input type="hidden" name="_template" value="table">

  <!-- Cliente -->
  <details open>
    <summary>Datos del Cliente</summary>
    <label>Nombre de la Empresa:</label><input type="text" name="empresa" id="empresa" required>
    <label>Atenci√≥n de:</label><input type="text" name="atencion">
    <label>Domicilio:</label><input type="text" name="domicilio">
    <label>CP / Provincia / Localidad:</label><input type="text" name="cp_prov_localidad">
    <label>NIF / CIF / NIE:</label><input type="text" name="nif">
    <label>Tel√©fono:</label><input type="text" name="telefono">
    <label>Email:</label><input type="email" name="email_cliente">
  </details>

  <!-- Comercial -->
  <details>
    <summary>Comercial Telekos</summary>
    <label>Nombre y Apellidos:</label><input type="text" name="comercial_nombre">
    <label>Tel√©fono M√≥vil:</label><input type="text" name="comercial_movil">
    <label>Email:</label><input type="email" name="comercial_email">
    <label>Tel√©fono Fijo:</label><input type="text" name="comercial_fijo" value="91 088 50 50">
  </details>

  <!-- Servicios -->
  <details>
    <summary>Servicios Contratados</summary>
    <div style="overflow-x:auto;">
    <table id="tablaServicios">
      <thead>
        <tr><th>Cant.</th><th>Servicio</th><th>Coste Mensual (‚Ç¨)</th><th>Total (‚Ç¨)</th><th>Eliminar</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><input type="number" name="cant[]" min="1" value="1" class="cant"></td>
          <td><input type="text" name="servicio[]" placeholder="Centralita, SMS, etc."></td>
          <td><input type="number" name="coste[]" step="0.01" value="0" class="coste"></td>
          <td class="total">0.00</td>
          <td><button type="button" class="btn eliminar">X</button></td>
        </tr>
      </tbody>
    </table>
    </div>
    <button type="button" class="btn" id="agregarServicio">‚ûï Agregar servicio</button>
    <label>Coste de instalaci√≥n (‚Ç¨ IVA incl.):</label><input type="number" step="0.01" id="instalacion" name="instalacion" value="0">
    <p class="totales">Subtotal mensual: <span id="subtotal">0.00</span> ‚Ç¨</p>
    <p class="totales">IVA (21%): <span id="iva">0.00</span> ‚Ç¨</p>
    <p class="totales">Total mensual con IVA: <span id="totalConIVA">0.00</span> ‚Ç¨</p>
  </details>

  <!-- Estudio -->
  <details>
    <summary>Estudio del Cliente y Amortizaci√≥n</summary>
    <h3 style="color:#004b8d;">Comparativa de Gastos</h3>
    <div style="overflow-x:auto;">
    <table id="tablaEstudio">
      <thead>
        <tr><th>Servicio</th><th>Gasto Actual (‚Ç¨)</th><th>Nuevo Gasto (‚Ç¨)</th><th>Ahorro Mensual (‚Ç¨)</th><th>Eliminar</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><input type="text" name="servicio_estudio[]" placeholder="Telefon√≠a fija, m√≥vil, etc."></td>
          <td><input type="number" name="gasto_actual[]" step="0.01" class="gasto_actual"></td>
          <td><input type="number" name="nuevo_gasto[]" step="0.01" class="nuevo_gasto"></td>
          <td><input type="number" name="ahorro_mensual[]" step="0.01" class="ahorro_mensual" readonly></td>
          <td><button type="button" class="btn eliminarEstudio">X</button></td>
        </tr>
      </tbody>
    </table>
    </div>
    <button type="button" class="btn" id="agregarEstudio">‚ûï Agregar concepto</button>
    <p class="totales">Ahorro anual estimado: <span id="ahorro_anual">0.00</span> ‚Ç¨</p>
    <p class="totales">Amortizaci√≥n estimada: <span id="amortizacionMeses">‚Äî</span> meses</p>
  </details>

  <!-- Observaciones -->
  <details>
    <summary>Observaciones y Legales</summary>
    <textarea name="observaciones" rows="4" placeholder="Notas o condiciones especiales..."></textarea>
    <p><strong>Nota:</strong><mark> Los servicios facturados por Telekos no implican compromisos de permanencia ni penalizaciones asociadas.</mark></p>
  </details>

  <!-- Firma -->
  <details>
    <summary>Firma Cliente</summary>
    <label>Firma o Nombre y Apellidos:</label><input type="text" name="nombre_cliente">
    <label>Fecha:</label><input type="date" name="fecha_cliente">
  </details>

  <div style="text-align:center;">
    <button type="submit" class="btn">üìß Enviar Formulario</button>
    <button type="button" class="btn" onclick="window.print()">üñ®Ô∏è Imprimir / Guardar PDF</button>
    
  </div>
</form>

<div class="footer">
  <p>Telekos ¬© 2025 ‚Äî <a href="https://www.telekos.com" target="_blank">www.telekos.com</a></p>
</div>

<script>
const form = document.getElementById("telekosForm");
const tablaServicios = document.querySelector("#tablaServicios tbody");
const tablaEstudio = document.querySelector("#tablaEstudio tbody");
const instalacionEl = document.getElementById("instalacion");
const subtotalEl = document.getElementById("subtotal");
const ivaEl = document.getElementById("iva");
const totalConIVAEl = document.getElementById("totalConIVA");
const ahorroAnualEl = document.getElementById("ahorro_anual");
const amortizacionMesesEl = document.getElementById("amortizacionMeses");
const steps = document.querySelectorAll(".step");
const progressFill = document.getElementById("progressFill");

function calcularTotales() {
  let subtotal = 0;
  tablaServicios.querySelectorAll("tr").forEach(row => {
    const cant = parseFloat(row.querySelector(".cant").value) || 0;
    const coste = parseFloat(row.querySelector(".coste").value) || 0;
    const total = cant * coste;
    row.querySelector(".total").textContent = total.toFixed(2);
    subtotal += total;
  });
  const instalacion = parseFloat(instalacionEl.value) || 0;
  const iva = (subtotal + instalacion) * 0.21;
  const totalConIVA = subtotal + instalacion + iva;
  subtotalEl.textContent = subtotal.toFixed(2);
  ivaEl.textContent = iva.toFixed(2);
  totalConIVAEl.textContent = totalConIVA.toFixed(2);
  actualizarTimeline();
  calcularEstudio();
}

function calcularEstudio() {
  let ahorroTotalMensual = 0;
  tablaEstudio.querySelectorAll("tr").forEach(row => {
    const actual = parseFloat(row.querySelector(".gasto_actual").value) || 0;
    const nuevo = parseFloat(row.querySelector(".nuevo_gasto").value) || 0;
    const ahorro = actual - nuevo;
    row.querySelector(".ahorro_mensual").value = ahorro.toFixed(2);
    ahorroTotalMensual += ahorro;
  });
  const ahorroAnual = ahorroTotalMensual * 12;
  ahorroAnualEl.textContent = ahorroAnual.toFixed(2);
  const instalacion = parseFloat(instalacionEl.value) || 0;
  amortizacionMesesEl.textContent = ahorroTotalMensual > 0 ? (instalacion / ahorroTotalMensual).toFixed(1) : "‚Äî";
}

function actualizarTimeline() {
  steps[0].classList.toggle("active", document.getElementById("empresa").value.trim() !== "");
  steps[1].classList.toggle("active", Array.from(tablaServicios.querySelectorAll(".coste")).some(c => parseFloat(c.value) > 0));
  steps[2].classList.toggle("active", Array.from(tablaEstudio.querySelectorAll(".gasto_actual")).some(g => g.value.trim() !== ""));
  steps[3].classList.toggle("active", document.querySelector("textarea[name='observaciones']").value.trim() !== "");
  steps[4].classList.toggle("active", parseFloat(instalacionEl.value) > 0);
  steps[5].classList.toggle("active", document.querySelector("input[name='fecha_cliente']").value.trim() !== "");
  const activeCount = document.querySelectorAll(".step.active").length;
  progressFill.style.width = (activeCount / steps.length * 100) + "%";
}

// Agregar/eliminar filas
document.getElementById("agregarServicio").onclick = () => {
  const row = document.createElement("tr");
  row.innerHTML = `<td><input type="number" name="cant[]" min="1" value="1" class="cant"></td>
  <td><input type="text" name="servicio[]" placeholder="Nuevo servicio"></td>
  <td><input type="number" name="coste[]" step="0.01" value="0" class="coste"></td>
  <td class="total">0.00</td>
  <td><button type="button" class="btn eliminar">X</button></td>`;
  tablaServicios.appendChild(row);
};
tablaServicios.onclick = e => { if(e.target.classList.contains("eliminar")) e.target.closest("tr").remove(), calcularTotales(); };

document.getElementById("agregarEstudio").onclick = () => {
  const row = document.createElement("tr");
  row.innerHTML = `<td><input type="text" name="servicio_estudio[]" placeholder="Nuevo concepto"></td>
  <td><input type="number" name="gasto_actual[]" step="0.01" class="gasto_actual"></td>
  <td><input type="number" name="nuevo_gasto[]" step="0.01" class="nuevo_gasto"></td>
  <td><input type="number" name="ahorro_mensual[]" step="0.01" class="ahorro_mensual" readonly></td>
  <td><button type="button" class="btn eliminarEstudio">X</button></td>`;
  tablaEstudio.appendChild(row);
};
tablaEstudio.onclick = e => { if(e.target.classList.contains("eliminarEstudio")) e.target.closest("tr").remove(), calcularEstudio(); };

// Eventos
tablaServicios.addEventListener("input", calcularTotales);
tablaEstudio.addEventListener("input", calcularEstudio);
instalacionEl.addEventListener("input", calcularTotales);
document.querySelector("textarea[name='observaciones']").addEventListener("input", actualizarTimeline);
document.getElementById("empresa").addEventListener("input", actualizarTimeline);
document.querySelector("input[name='fecha_cliente']").addEventListener("input", actualizarTimeline);

// Inicializar al cargar
window.addEventListener("load", () => {
  calcularTotales();
  calcularEstudio();
  actualizarTimeline();
});


// Confirmaci√≥n al enviar y limpiar formulario
form.addEventListener("submit", () => {
  alert("üì® Tu propuesta se ha enviado correctamente. ¬°Gracias!");
  form.reset();
  calcularTotales();
  calcularEstudio();
  actualizarTimeline();
});
</script>

</body>
</html>
